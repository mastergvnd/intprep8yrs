package com.essbase.japi;

import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;

public class Writer {
	public static String NEW_LINE = "<br/>";
	private static BufferedWriter writer = null;
	public static String higHlightRed = "RED";
	public static String higHlightGreen = "GREEN";
	public static String higHlightWHITE = "WHITE";
	static{
		try {
			System.out.println("writer initialized");
			writer = new BufferedWriter(new FileWriter("D:\\diff.html"));
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
	public static void write(String text, String separator) throws IOException{
		writer.append(text+separator);
	}
	public static void closeWriter() throws IOException{
		writer.close();
	}
	public static void write(String source, String target, int sIndentation, int tIndentation) throws IOException{
		if(source == null)
			writer.append("<html><font color='"+higHlightGreen+"'style=\"background-color:#eacbdb;padding-left:"+tIndentation+"em;\">"+target+NEW_LINE);
		else if (target == null)
			writer.append("<html><font color='"+higHlightRed+"'style=\"background-color:#eacbdb;padding-left:"+sIndentation+"em;\">"+source+NEW_LINE);
		else if(source.equals(target)){
			writer.append("<html><font color='"+higHlightGreen+"'style=\"background-color:#eacbdb;padding-left:"+sIndentation+"em;\">"+source);
			writer.append("<html><font color='"+higHlightRed+"'style=\"background-color:#eacbdb;padding-left:"+tIndentation+"em;\">"+target);
		}
		else{
			writer.append("<html><font color='"+higHlightWHITE+"'style=\"background-color:#eacbdb;padding-left:"+sIndentation+"em;\">"+source);
			writer.append("<html><font color='"+higHlightWHITE+"'style=\"background-color:#eacbdb;padding-left:"+tIndentation+"em;\">"+target);
		}
	}
}
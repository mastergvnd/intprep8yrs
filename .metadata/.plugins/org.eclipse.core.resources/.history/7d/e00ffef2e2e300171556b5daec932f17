package com.essbase.japi;

import java.util.List;

import com.essbase.api.base.EssException;
import com.essbase.api.metadata.IEssDimension;
import com.essbase.api.metadata.IEssMember;

public class EssBaseOperations {

	public static void main(String[] args) {

		EssBaseCube cube = new EssBaseCube();
		cube.setApplicationName("SampCopy");
		cube.setCubeName("East");

		try {
			EssBaseConnectionManager.connectToCube(cube);
			cube.load();

			System.out.println("Number of dimensions : " + cube.getCube().getCountDimensions());
			List<IEssDimension> dimensionsList = EssBaseUtil.readDimensionsAsList(cube.getCubeOutline());
			List<IEssMember> membersList = EssBaseUtil.readMembers(dimensionsList);

			EssBaseUtil.readDimensionProperties(dimensionsList);
			EssBaseUtil.readMemberProperties(membersList);
		} catch (EssException e) {
			System.out.println("Error : " + e.getMessage());
			e.printStackTrace();
		} finally {
			EssBaseConnectionManager.comeOutClean(cube);
		}
	}
}
